%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%	Package de personnalisation du package UPSTI_Document
% -----------
% Auteur: Emmanuel Pinault-Bigeard
% email: e.pinault-bigeard@upsti.fr
% -----------
% Version: 1.0 - 2017/11/23
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% UPSTI - http://www.upsti.fr
% CC BY-NC-SA 2.0 FR - http://creativecommons.org/licenses/by-nc-sa/2.0/fr/
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\NeedsTeXFormat{LaTeX2e}[1999/01/01]
\ProvidesPackage{UPSTI_Custom}[2017/11/23]

%==============================================================================%
%	Changelog
%==============================================================================%
% 1.0 - 2017/11/23 - Mise en ligne de la première version


%==============================================================================%
% Personnalisation du modèle
%==============================================================================%
%--------------------------------------------------------%
% Images
%--------------------------------------------------------%
\newcommand{\UPSTIcheminImages}{/Users/geoffreyvaquette/UPSTIlatex/Vaquette/}
\newcommand{\UPSTIlogoLicence}{\UPSTIcheminImages logoLicence.png}
\newcommand{\UPSTIlogoLycee}{\UPSTIcheminImages logoLycee}
\newcommand{\UPSTIlogoAuteur}{\UPSTIcheminImages logoAuteur.png}
\newcommand{\UPSTIlogoAuteurCollegial}{\UPSTIcheminImages logoAuteurCollegial.png}

%--------------------------------------------------------%
% En-têtes et pieds de page
%--------------------------------------------------------%
% En-têtes de pages
\newcommand{\UPSTIenTetePrincipalFiliere}{}
\newcommand{\UPSTIcoordonneesLycee}{Lycée Louis Armand, 16 bis Avenue Marc Sangnier 75014 Paris}

% Pied de page
\newcommand{\UPSTIfooterWebSite}{http://louis-armand.paris/}
\newcommand{\UPSTIfooterLycee}{Lycée Louis Armand}
\newcommand{\UPSTIfooterWebSiteCollegial}{www.upsti.fr}

%--------------------------------------------------------%
% Meta données du pdf
%--------------------------------------------------------%
\newcommand{\UPSTIauteur}{Geoffrey Vaquette}
\newcommand{\UPSTImail}{geo.vaquette@gmail.com}

%--------------------------------------------------------%
% Définition des couleurs
%--------------------------------------------------------%
\colorlet{UPSTIcouleurCorrige}{red}
\colorlet{UPSTIcustomColor1}{RoyalBlue}
\colorlet{UPSTIcustomColor2}{red}
\colorlet{UPSTIcustomColor3}{purple}
\colorlet{UPSTIcustomColor4}{ForestGreen}
\colorlet{UPSTIcustomColor5}{Orange}

%--------------------------------------------------------%
% Quelques exemples de personnalisation
%--------------------------------------------------------%
%\renewcommand{\UPSTIversionProf}{\textcolor{red}{~\raisebox{1pt}{$\bigstar$}}} % Signe distinctif pour montrer que c'est une version corrigée (dans l'en-tête)
%\renewcommand*{\UPSTIarrondiBoites}{0} % Arrondi des coins des boîtes
%\renewcommand{\UPSTIintituleKholle}{Khôlle}
\renewcommand{\UPSTIheaderLeft}{STI2D}


  % %~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~%
  % % Version du document à compiler
  % %~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~%
  % % - 1: Version prof, avec corrigés et zones à compléter en couleur (rouge par défaut)
  % % - 2: Version élève, sans les corrigés (!) et avec les zones à compléter éventuelles vides (ie: écrites en blanc)
  % % - 3: Version "publiée", sans les corrigés et avec les éventuelles zones à compléter en noir.
  % \ifdef{\UPSTIidVersionDocument}{}{\newcommand{\UPSTIidVersionDocument}{1}} % Par défaut: prof
  % \ifthenelse{\equal{\ChoixDeVersion}{U}}
  % {\newcommand{\UPSTIidVersionDocumentDef}{\UPSTIidVersionDocument}} % U: Choix défini par l'utilisateur dans le fichier tex
  % {
  %   \ifthenelse{\equal{\ChoixDeVersion}{P}}
  %     {\newcommand{\UPSTIidVersionDocumentDef}{1}}      % P: Version prof
  %     {
  %       \ifthenelse{\equal{\ChoixDeVersion}{E}}
  %         {\newcommand{\UPSTIidVersionDocumentDef}{2}}  % E: Version élève
  %         {\newcommand{\UPSTIidVersionDocumentDef}{3}}  % Pub: Version pour la publication
  %     }
  % }

\newcommand{\UPSTIlignesACompleter}[2][3]{\ifnumequal{2}{\UPSTIidVersionDocumentDef}{\UPSTIpointilles[#1]}{\color{UPSTIcouleurCorrige}{#2}\color{black}}}


%-------------------------------------------------------%
% Des pointillés pour les documents à compléter
%-------------------------------------------------------%

  % % Définition des couleurs utilisées dans les zones à compléter selon la version du doc
  % \ifcase\UPSTIidVersionDocumentDef
  %   Erreur dans UPSTIidVersionDocumentDef (=0)
  %   \or \newcommand{\UPSTITailleZoneACompleter}{\Large}   % Document prof
  %   \or \newcommand{\UPSTITailleZoneACompleter}{\Large}                  % Document élève
  %   \or \newcommand{\UPSTITailleZoneACompleter}{\normalsize}                  % Document à publier
  %   \else Erreur dans UPSTIidVersionDocumentDef (Trop grand)
  % \fi

\renewcommand{\UPSTIaCompleter}[1]{\Large\textcolor{UPSTIcouleurZoneACompleter}{#1}}


%==============================================================================%
% Override: on peut définir ici des changements de variables conditionnels pour le modèle, en fonction de la valeur de \UPSTIvariante
%==============================================================================%
%--------------------------------------------------------%
% Cas général
%--------------------------------------------------------%
\newcommand{\UPSTIeditCustomVars}{

  % Pour overrider certaines macros quelque soit la variante du document
  % \renewcommand*{\nomDeLaCommande} {Valeur}

  % Définition des variantes (si on édite des documents pour différents lycées)
  \ifdef{\UPSTIvariante}{
  \ifcase\UPSTIvariante

    % ~~~~~~~~~~~~~~~~
    % Variante 0: UPSTI (ne pas modifier cette section)
    % ~~~~~~~~~~~~~~~~
    \renewcommand{\UPSTIcheminImages}{C:/UPSTIlatex/UPSTI/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE}
    \renewcommand{\UPSTIcoordonneesLycee}{}
    \renewcommand{\UPSTIfooterWebSite}{www.upsti.fr}
    \renewcommand{\UPSTIfooterLycee}{UPSTI}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{www.upsti.fr}
    \renewcommand{\UPSTIauteur}{UPSTI}
    \renewcommand{\UPSTImail}{contact@upsti.fr}
    \colorlet{UPSTIcustomColor1}{blue}
    % ~~~~~~~~~~~~~~~~

  \or
    % Variante 1: Lycée n°2 (Chaptal)
    \renewcommand{\UPSTIcheminImages}{C:/UPSTIlatex/Chaptal/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée Chaptal – 45 Boulevard des Batignolles – 75008 Paris}
    \renewcommand{\UPSTIfooterWebSite}{}
    \renewcommand{\UPSTIfooterLycee}{Lycée Chaptal - Paris}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{www.lycee-chaptal-paris.fr}
    \renewcommand{\UPSTIauteur}{Sébastien GERGADIER}
    \renewcommand{\UPSTImail}{prof2sii@gmail.com}
    \colorlet{UPSTIcustomColor2}{ForestGreen}
    \colorlet{UPSTIcustomColor4}{blue}

  \or
    % Variante 2: Lycee n°3 (Jean Zay)
    \renewcommand{\UPSTIcheminImages}{C:/UPSTIlatex/JeanZay/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE PTSI/PT}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée Jean Zay – 21 rue Jean Zay – 63300 Thiers – Académie de Clermont-Ferrand}
    \renewcommand{\UPSTIfooterLycee}{Lycée Jean Zay - Thiers}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{http://www.lyceejeanzay.net/}

  \or
    % Variante 3: Lycee n°4 (Michelet)
    \renewcommand{\UPSTIcheminImages}{C:/UPSTIlatex/Michelet/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée Michelet – 5 Rue Jullien – 92170 Vanves – Académie de Versailles}
    \renewcommand{\UPSTIfooterLycee}{Lycée Michelet - Vanves}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{http://www.michelet-vanves.ac-versailles.fr/}
    \renewcommand{\UPSTIidClasse}{3}  % Forcément PCSI...

  \or
    % Variante 4: Lycee n°5 (Richelieu)
    \renewcommand{\UPSTIcheminImages}{C:/UPSTIlatex/Richelieu/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE TSI}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée Richelieu – 64, rue George Sand – 92500 Rueil-Malmaison – Académie de Versailles}
    \renewcommand{\UPSTIfooterLycee}{Lycée Richelieu - Rueil-Malmaison}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{www.lyc-richelieu-rueil.ac-versailles.fr}

  \or
  	% Variante 5 : Lycée n°6 (Dorian)
  	\renewcommand{\UPSTIcheminImages}{/Users/geoffreyvaquette/UPSTIlatex/Dorian/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE PTSI/PT}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée Dorian – 74 Avenue Philippe-Auguste, 75011 Paris}
    \renewcommand{\UPSTIfooterLycee}{Lycée Dorian - Paris}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{www.ac-paris.fr/serail/jcms/s1_120286/fr/accueil}

  \else
    % Par défaut

  \fi
  }{}
}


%--------------------------------------------------------%
% Dans certains cas, on peut avoir à spécifier des changements de variables ici...
%--------------------------------------------------------%
\newcommand{\UPSTIeditCustomVarsEnd}{
  \ifdef{\UPSTIvariante}{
  \ifcase\UPSTIvariante

    % Variante 0: Lycée Michelet

    \or
      % Variante 1: Seb à Chaptal

    \or
      % Variante 2

    \else
      % Par défaut

  \fi
  }{}

  % Override de variables/commandes
  %\colorlet{UPSTIcustomColor1}{green}  % Exemple: si on veut forcer la CustomColor1 à vert, quelles que soient les modifications de la variable faites précédemment...


  %==============================================================================%
  % Versioning (à utiliser avec le script de compilation)
  % Supprimez ou commenter cette section si vous n'utilisez pas le vbscript de compilation rapide
  %==============================================================================%
  % Packages nécessaires
  \RequirePackage{catchfile}              % |
  \RequirePackage{atveryend}              % | Gestion des fichiers de version et révisions
  \RequirePackage{newfile}                % |

  % % On incrémente le compteur dans le fichier révision, pour savoir par curiosité le nombre de compilations totale du fichier
  % \newcounter{revisions}
  % \IfFileExists{\jobname.revision}{%
  %   \begingroup
  %     \CatchFileEdef\tmp{\jobname.revision}{\endlinechar=-1\relax}%
  %     \setcounter{revisions}{\tmp}%
  %   \endgroup
  % }{}
  % \stepcounter{revisions}

  % % On créée un fichier de version en fonction de la variable \UPSTInumeroVersion
   \ifdef{\UPSTInumeroVersion}{
   \AtVeryEndDocument{%
  %   \newoutputstream{revision}%
  %   \openoutputfile{\jobname.revision}{revision}%
  %   \addtostream{revision}{\number\value{revisions}}%
  %   \closeoutputstream{revision}%
    \newoutputstream{version}%
    \openoutputfile{\jobname.version}{version}%
    \addtostream{version}{\UPSTInumeroVersion}%
    \closeoutputstream{version}%
  }
  }{}
}
\endinput
